{%- macro control_group(label, field) %}
    <div class="control-group">
     <label class="control-label" for="{{field}}">{{label}}</label>
     <div class="controls">
      {{ caller() }}
     </div>
    </div>
{%- endmacro %}
{%- macro input(label, field, value="", alert=None, readonly=False) %}
    {% call control_group(label, field) %}
       <input type="text" name="{{field}}" placeholder="{{label}}" value="{{value}}" {{"readonly" if readonly}} autocomplete="off">
    {% endcall %}
{%- endmacro %}
{%- macro textarea(label, field, value="", placeholder="", rows=2, alert=None, readonly=False) %}
    {% call control_group(label, field) %}
       <textarea name="{{field}}" placeholder="{{placeholder}}" rows="{{rows}}" {{"readonly" if readonly}}>{{ value }}</textarea>
    {% endcall %}
{%- endmacro %}
{%- macro submit_btn(title="Submit") %}
    <div class="control-group">
     <div class="controls">
      <button type="submit" class="btn btn-primary">{{title}}</button>
     </div>
    </div>
{%- endmacro %}

{# https://gist.github.com/ligthyear/1284631 #}

{%- macro form_field_label(field) -%}
    <label for="{{ field.id }}">{{ field.label.text }}
    {%- if field.flags.required -%}
        <abbr title="Required">*</abbr>
    {%- endif %}</label>
{% endmacro %}
 
{%- macro form_field_description(field) -%}
    {% if field.description %}
        <span class="descr">{{ field.description }}</span>
    {% endif %}
{%- endmacro -%}
 
{%- macro form_field_errors(field) -%}
    {% if field.errors %}
    <div>
        {%- for error in field.errors -%}
        <span class="label important">{{ error }}</span>
        {%- endfor -%}
    </div>
    {% endif %}
{%- endmacro -%}
 
{%- macro form_field_boolean(field) -%}
    <div class="input">
      <label>
        {{ field(**kwargs) }}
        <span>{{ field.label.text }}</span>
        {{ form_field_description(field) }}
        {{ form_field_errors(field) }}
      </label>
    </div>
{%- endmacro -%}
 
{%- macro action_buttons(submit_title, cancel_title="Cancel", submit_class="primary") -%}
    <div class="actions">
      <input type="submit" class="btn {{submit_class}}" value="{{submit_title}}">
      &nbsp;
      <button type="reset" class="btn">{{cancel_title}}</button>
    </div>
{%- endmacro -%}
 
{%- macro form_field(field) -%}
    <div class="clearfix">
    {% if field.type == 'HiddenField' %}
       {{ field() }}
    {% else %}
       {% if field.type == 'BooleanField' %}
          {{ form_field_boolean(field, **kwargs) }}
       {% else%}
          {{ form_field_label(field) }}
          <div class="input" id="{{field.id}}-div">
          {% if field.type == 'RadioField' %}
             {{ field(class='radio-group', **kwargs) }}
          {% else %}
             {{ field(**kwargs) }}
          {% endif %}
          {{ form_field_description(field) }}
          {{ form_field_errors(field) }}
          </div>
       {% endif %}
    {% endif %}
    </div>
{%- endmacro -%}
 
{%- macro form_fields(fields, class=None, legend=None) -%}
    <fieldset {% if class %}class="{{class}}"{% endif %}>
    {% if legend %}
      <legend>{{legend}}</legend>
    {% endif %}
    {% for field in fields %}
      {% if field.type == 'HiddenField' %}
         {{ field() }}
      {% else %}
         {{ form_field(field) }}
      {% endif %}
    {% endfor %}
    </fieldset>
{%- endmacro -%}
